# 综合登录功能测试用例

## 测试名称
用户登录功能测试（含验证码）

## 测试描述
验证用户能够成功登录系统，包括用户名、密码、验证码输入和登录按钮点击，覆盖多种验证码类型和异常场景

## 前置条件
- 用户已注册账号
- 系统正常运行
- 登录页面可访问
- 验证码功能已启用
- 网络连接正常

## 主要测试场景

### 场景1：正常登录流程
**测试步骤**：
1. 打开登录页面
2. 在用户名输入框中输入有效的用户名
3. 在密码输入框中输入对应的密码
4. 获取验证码图片
5. 在验证码输入框中输入正确的验证码
6. 点击登录按钮
7. 验证成功跳转到用户主页
8. 验证用户信息正确显示

**期望结果**：
- 登录成功
- 页面跳转到用户主页
- 显示用户欢迎信息
- 导航菜单显示用户相关选项
- 验证码输入正确
- 登录按钮状态正确

### 场景2：图形验证码测试
**测试步骤**：
1. 打开登录页面
2. 观察验证码图片是否正确显示
3. 点击验证码刷新按钮
4. 验证码图片更新
5. 输入用户名、密码和新的验证码
6. 点击登录按钮

**期望结果**：
- 验证码图片清晰可读
- 刷新按钮正常工作
- 新验证码有效
- 登录成功

### 场景3：数字验证码测试
**测试步骤**：
1. 打开登录页面
2. 检查验证码是否为纯数字
3. 输入用户名、密码和数字验证码
4. 点击登录按钮

**期望结果**：
- 验证码为4-6位数字
- 数字验证码输入正确
- 登录成功

### 场景4：字母数字混合验证码测试
**测试步骤**：
1. 打开登录页面
2. 检查验证码是否包含字母和数字
3. 输入用户名、密码和混合验证码
4. 点击登录按钮

**期望结果**：
- 验证码包含字母和数字
- 混合验证码输入正确
- 登录成功

## 异常场景测试

### 异常场景1：验证码错误
**测试步骤**：
1. 输入正确的用户名和密码
2. 输入错误的验证码
3. 点击登录按钮

**期望结果**：
- 显示验证码错误提示
- 验证码图片刷新
- 仍在登录页面
- 错误提示信息清晰

### 异常场景2：验证码过期
**测试步骤**：
1. 获取验证码图片
2. 等待验证码过期（通常5分钟）
3. 输入正确的用户名、密码和验证码
4. 点击登录按钮

**期望结果**：
- 显示验证码过期提示
- 需要重新获取验证码
- 提示信息明确

### 异常场景3：验证码刷新功能
**测试步骤**：
1. 获取验证码图片
2. 点击验证码刷新按钮
3. 验证码图片更新
4. 输入新的验证码

**期望结果**：
- 验证码图片成功刷新
- 旧验证码失效
- 新验证码可用
- 刷新按钮响应及时

### 异常场景4：验证码输入框验证
**测试步骤**：
1. 输入用户名和密码
2. 不输入验证码直接点击登录
3. 输入不完整验证码点击登录
4. 输入格式错误的验证码

**期望结果**：
- 显示验证码必填提示
- 显示验证码格式错误提示
- 表单验证正常工作

## 测试数据

### 有效用户数据
- **用户名**: testuser@example.com
- **密码**: TestPassword123
- **验证码**: 从验证码图片中识别（如：ABC123、123456、A1B2C3）

### 无效用户数据
- **用户名**: invalid@example.com
- **密码**: WrongPassword
- **验证码**: WRONG

### 测试验证码数据
- **数字验证码**: 123456
- **字母验证码**: ABCDEF
- **混合验证码**: A1B2C3
- **错误验证码**: XYZ999

## 页面元素选择器

### 输入框
- **用户名输入框**: `input[name="username"], input[type="email"], #username, [data-testid="username"]`
- **密码输入框**: `input[name="password"], input[type="password"], #password, [data-testid="password"]`
- **验证码输入框**: `input[name="captcha"], input[name="verification"], #captcha, [data-testid="captcha"]`

### 按钮
- **登录按钮**: `button[type="submit"], input[type="submit"], .login-btn, [data-testid="login-button"]`
- **验证码刷新按钮**: `.captcha-refresh, .refresh-captcha, [data-testid="captcha-refresh"]`

### 图片
- **验证码图片**: `img[alt*="验证码"], img[alt*="captcha"], .captcha-image, [data-testid="captcha-image"]`

### 提示信息
- **错误提示**: `.error-message, .alert-danger, [data-testid="error-message"]`
- **成功提示**: `.success-message, .alert-success, [data-testid="success-message"]`

## 验证要点

### 功能验证
- [ ] 用户名输入框正常工作
- [ ] 密码输入框正常工作
- [ ] 验证码输入框正常工作
- [ ] 验证码图片正确显示
- [ ] 验证码刷新功能正常
- [ ] 登录按钮状态正确
- [ ] 表单验证正常工作

### 安全验证
- [ ] 验证码一次性使用
- [ ] 验证码过期机制
- [ ] 错误尝试限制
- [ ] 密码输入安全（隐藏显示）

### 用户体验验证
- [ ] 页面加载速度
- [ ] 验证码图片清晰度
- [ ] 错误提示信息清晰
- [ ] 按钮响应及时
- [ ] 表单数据保留

## 后置条件
- 用户已成功登录
- 用户会话已建立
- 用户被重定向到主页
- 验证码已失效（一次性使用）
- 登录状态正确保存

## 注意事项
1. 验证码识别可能需要人工干预
2. 验证码刷新频率需要控制
3. 测试环境需要稳定的网络连接
4. 验证码图片质量需要保证
5. 错误提示信息需要本地化 